Equipment Reserve Actions

A list of actions that the people using the system can take, and the role(s) necessary to take each action.

GENERAL DESIGN/IMPLEMENTATION NOTE: 
    all data manipulation actions should be implemented as ajax calls when possible, 
    but navigation uses full page reloads

------------------------------------
ALL USERS
------------------------------------

View index page w/ log in form
    reqs: 
        currently in an unauthenticated session
    effects:
        WEB:
            display tool title & other relevant public info
            display log in form (https)
        
Log in
    reqs:
        has an LDAP account
        currently in an unauthenticated session
    effects:
        WEB:
            establish an authenticated session
        DB:
            if no eqreserve users table entry, create one and associated groups (if needed) and link_users_groups
            else update users table, groups, and link_users_groups
        LOG?:
            track user log in event

Log out
    reqs:
        currently in an authenticated session
    effects:
        WEB:
            unauthenticate the session
        LOG?:
            track user log out event

View index page w/ tool active
    reqs: 
        currently in an authenticated session
    effects:
        WEB:
            show list of allowed system actions
            show list of eq_groups, indicating level of access for each one
        LOG?:
            track user index view

------------------------------------
ADMINS
------------------------------------

System action: create user
    reqs: 
        currently in an authenticated session
        user has admin role
    notes: needs an LDAP search feature
    effects:
        WEB: display a user creation form
        DB: create a users record, or update it if one already exists
        LOG?:
            track user action

System action: look up user or institutional (LDAP) group
    reqs: 
        currently in an authenticated session
        user has admin role
    effects:
        WEB:
            display a search form
            display result set w/ record summaries for 2+ results
                w/ links to single user or inst group view/edit
                visual cue users vs inst groups
            jump directly to single user or inst_group view/edit if 1 result
            ??? if no local user, jump to LDAP search?
        DB: select set of users based on criteria
        LOG?:
            track user action

System action: view/edit base user info
    reqs: 
        currently in an authenticated session
        user has admin role
    effects:
        WEB: display user info, with each field that can be edited in an editable form
        DB: retrieve and update a single users record
        LOG?:
            track user action

System action: view/edit institutional (LDAP) group info
    reqs: 
        currently in an authenticated session
        user has admin role
    effects:
        WEB: display inst_group info, with each field that can be edited in an editable form
        DB: retrieve and update a single inst_groups record
        LOG?:
            track user action

System action: globally ban a user or institutional (LDAP) group
    reqs: 
        currently in an authenticated session
        user has admin role
    effects:
        WEB: a button/check on the edit user page
        DB: flip the flag_is_banned field for the user
        LOG?:
            track user action

System action: edit user/inst_group roles for eq_groups
    reqs: 
        currently in an authenticated session
        user has admin role
    notes: 
        editing access / roles from a group perspective is described / handled in the Group actions below
        'banned' has the same effects as 'none', but can be reported on and is actively indicative of state
    effects:
        WEB:
            select a user or entity from a list / search result, or from the view / edit form for that user / inst_group
            for a given user or group entity, list all eq groups, with current role for each group (banned, none, user, manager)
            allow changing of roles
        DB: 
            adds, or deletes (or updates - maybe? might just do ti all w/ adds/deletes) link_entity_roles_eq_groups records
        LOG?:
            track user action

System action: create equipment group
    reqs: 
        currently in an authenticated session
        user has admin role
    effects:
        WEB: displays form for creating an equipment group
        DB: eq_groups record created
        LOG?:
            track user action

NOTE: editing an equipment group is described / handled in the Group actions below

System action: delete equipment groups
    reqs: 
        currently in an authenticated session
        user has admin role
    effects:
        WEB:
            list all equipment groups
            'delete' them
        DB:
            mark appropriate eq_group record(s) as deleted
        LOG?:
            track user action

------------------------------------
MANAGERS (and ADMINS? might just require an admin to grant themselves manager role for the relevant group)
------------------------------------

Group action: view/edit group info
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
            display eq group info, with each field that can be edited in an editable form
            show list of entities that have roles in the group (sortable by entity type, name, and role) - see DKC's work w/ sortable tables
                quick-form (ajax-y) for adding a new entity role
                    include on-the-fly entity creation?
            list eq sub-groups and eq items, appropriately organized
                with link to relevant controls
                with links to Adds for each
            show scheduling rule, and allow editing there-of
            show overview of scheduling/reservations for the group
                calendar format (days horizontally and items (sub-grouped) vertically?)
                list format
            create availability block(s)
            create admin reserve block(s)
            show links to any reporting
        DB:
            retrieve and update a single eq_groups record
            adds, or deletes (or updates - maybe? might just do ti all w/ adds/deletes) link_entity_roles_eq_groups records
            retrieve and update a single scheduling_rules record
        LOG?:
            track user action

Group action: (sub-action of view/edit group) make scheduling rules for this group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: (sub-action of view/edit group) create availability block for this group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: (sub-action of view/edit group) create an admin reserve block for this group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: (sub-action of view/edit group) re-order sub-groups
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    notes: this can also be done individually by editing specific sub-groups, but this is conceptually a separate action
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: (sub-action of view/edit group) create sub-group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: REPORTS on eq_group 
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
            over all activity, per item
                # users
                % in use
                ????
                specific users and times
            filter by time
                all
                historical
                upcoming/future
        DB: various SELECTs
        LOG?:
            track user action

-------------------

Group action: edit sub-group info
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: delete sub-group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: make scheduling rules for this sub-group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: create availability block for this sub-group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: create an admin reserve block for this sub-group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: re-order items within this sub-group
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    notes: this can also be done individually by editing specific items, but this is conceptually a separate action
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: create item
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: edit item
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: delete item
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: make scheduling rules for this item
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: create availability block for this item
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action

Group action: create an admin reserve block for this item
    reqs: 
        currently in an authenticated session
        user has manager role for this group
    effects:
        WEB:
        DB:
        LOG?:
            track user action
